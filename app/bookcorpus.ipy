# %%
import datasets as ds

bc = ds.load_dataset("bookcorpus", split="train")

with open("../data/selected-words.csv", "r") as file:
    next(file)
    words = [
        " " + word + " "
        for row in file.read().split("\n")
        for word in row.split(",")
        if word
    ]
# %%

filtered = bc.filter(lambda x: any(word in x["text"] for word in words))

# %%
filtered.save_to_disk("../data/bookcorpus-filtered")
